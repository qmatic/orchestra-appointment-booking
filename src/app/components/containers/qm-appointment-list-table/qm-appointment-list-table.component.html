<div class="qm-app-list-table-container">
  <h2 class="qm-app-list-table-container__heading" *ngIf="fulAppointmentList && fulAppointmentList.length > 0"> {{'label.list.heading' | translate}} <span
      *ngIf="branchName"> {{branchName}}</span> </h2>
  <hr>
  <div>
    <div class="qm-app-list-table-container__filters" *ngIf="fulAppointmentList && fulAppointmentList.length > 0">
      <div>
        {{'label.list.search' | translate}}  <input type="text" (change)="onSearchTxtChanged()" (keyup)="onSearchTxtChanged()"
          [(ngModel)]="searchText">
      </div>
      <div>
        {{'label.list.show' | translate}} <select name="" id="" (change)="onChangeElementsPerpage($event.target.value)">
          <option value="5"> 5 </option>
          <option value="10"> 10 </option>
          <option value="20"> 20 </option>
          <option value="{{fulAppointmentList.length}}"> {{'label.list.all' | translate}} </option>
        </select>
      </div>
      <div class="qm-app-list-table-container__filters-reports">
        <button class="qm-app-list-table-container__filters-button" (click)="exportToPdf()">    {{'label.list.pdf' | translate}}</button>
        <button class="qm-app-list-table-container__filters-button" (click)="exportToExcel()">  {{'label.list.xls' | translate}}</button>
      </div>
    </div>
    <hr>


    <div class="qm-app-list-table-container-list" *ngIf="fulAppointmentList && fulAppointmentList.length > 0">
      <table id="app-list">
        <tr>
          <th>
            {{'label.list.date' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('DATE')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'DATE' && sortByAsc) || (sortByCondition !== 'DATE' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
              <!-- <span class="sr-only">{{ sortByVisitIdAsc ? ('button.sortASC' | translate) : ('button.sortDES' | translate) }}</span> -->
            </button>
          </th>
          <th>  {{'label.list.start' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('START')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'START' && sortByAsc) || (sortByCondition !== 'START' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
              <!-- <span class="sr-only">{{ sortByVisitIdAsc ? ('button.sortASC' | translate) : ('button.sortDES' | translate) }}</span> -->
            </button>
          </th>
          <th>{{'label.list.end' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('END')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'END' && sortByAsc) || (sortByCondition !== 'END' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
              <!-- <span class="sr-only">{{ sortByVisitIdAsc ? ('button.sortASC' | translate) : ('button.sortDES' | translate) }}</span> -->
            </button>
          </th>
          <th>{{'label.list.first.name' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('FIRST_NAME')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'FIRST_NAME' && sortByAsc) || (sortByCondition !== 'FIRST_NAME' && !sortByAsc))  ? 'icon-caret-down': 'icon-caret-up'"></i>
              <!-- <span class="sr-only">{{ sortByVisitIdAsc ? ('button.sortASC' | translate) : ('button.sortDES' | translate) }}</span> -->
            </button>
          </th>
          <th> {{'label.list.last.name' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('LAST_NAME')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'LAST_NAME' && sortByAsc) || (sortByCondition !== 'LAST_NAME' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
              <!-- <span class="sr-only">{{ sortByVisitIdAsc ? ('button.sortASC' | translate) : ('button.sortDES' | translate) }}</span> -->
            </button>
          </th>
          <th> {{'label.list.resource' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('RESOURCE')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'RESOURCE' && sortByAsc) || (sortByCondition !== 'RESOURCE' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
              <!-- <span class="sr-only">{{ sortByVisitIdAsc ? ('button.sortASC' | translate) : ('button.sortDES' | translate) }}</span> -->
            </button>
          </th>
          <th> {{'label.list.notes' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('NOTE')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'NOTE' && sortByAsc) || (sortByCondition !== 'NOTE' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
              <!-- <span class="sr-only">{{ sortByVisitIdAsc ? ('button.sortASC' | translate) : ('button.sortDES' | translate) }}</span> -->
            </button>
          </th>
          <th>  {{'label.list.services' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('SERVICES')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'SERVICES' && sortByAsc) || (sortByCondition !== 'SERVICES' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
              <!-- <span class="sr-only">{{ sortByVisitIdAsc ? ('button.sortASC' | translate) : ('button.sortDES' | translate) }}</span> -->
            </button>
          </th>
          <th>{{'label.list.email' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('EMAIL')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'EMAIL' && sortByAsc) || (sortByCondition !== 'EMAIL' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
              <!-- <span class="sr-only">{{ sortByVisitIdAsc ? ('button.sortASC' | translate) : ('button.sortDES' | translate) }}</span> -->
            </button>
          </th>
          <th> {{'label.list.phone' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('PHONE')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'PHONE' && sortByAsc) || (sortByCondition !== 'PHONE' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
              <!-- <span class="sr-only">{{ sortByVisitIdAsc ? ('button.sortASC' | translate) : ('button.sortDES' | translate) }}</span> -->
            </button>
          </th>
          <th> {{'label.list.updated' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('UPDATED')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'UPDATED' && sortByAsc) || (sortByCondition !== 'UPDATED' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
              <!-- <span class="sr-only">{{ sortByVisitIdAsc ? ('button.sortASC' | translate) : ('button.sortDES' | translate) }}</span> -->
            </button>
          </th>
          <th>{{'label.list.status' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('STATUS')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'STATUS' && sortByAsc) || (sortByCondition !== 'STATUS' && !sortByAsc))? 'icon-caret-down': 'icon-caret-up'"></i>
              <!-- <span class="sr-only">{{ sortByVisitIdAsc ? ('button.sortASC' | translate) : ('button.sortDES' | translate) }}</span> -->
            </button>
          </th>
      
        </tr>
        <tr *ngFor="let appointment of appointmentList | slice: (currentPage-1) * elementsPerPage : currentPage * elementsPerPage">
          <td> {{ appointment.startTime | amDateFormat: 'DD-MM-YYYY' }}</td>
          <td> {{ appointment.startTime | amDateFormat: (isMilitaryTime ? 'HH:mm' : 'hh:mm A') }}</td>
          <td> {{ appointment.endTime | amDateFormat: (isMilitaryTime ? 'HH:mm' : 'hh:mm A') }}</td>
          <td> {{ appointment.customers[0].firstName }}</td>
          <td> {{ appointment.customers[0].lastName }}</td>
          <td> {{ appointment.resourceName }}</td>
          <td> {{ getNotes(appointment.properties.notes) }}</td>
          <td> {{ appointment.services[0].name }}</td>
          <td> {{ appointment.customers[0].properties.email }}</td>
          <td> {{ appointment.customers[0].properties.phoneNumber }}</td>
          <td> {{ appointment.updateTime | amDateFormat: (isMilitaryTime ? 'DD-MM-YYYY - HH:mm' : 'DD-MM-YYYY - hh:mm
            A') }}</td>
          <td> {{ appointment.status }}</td>
        </tr>
      </table>
    </div>

    <!-- Fake table for downloading pdf and xls -->
    <div class="qm-app-list-table-container-fake-list" aria-hidden="true" *ngIf="fulAppointmentList && fulAppointmentList.length > 0">
      <table id="app-full-list">
        <tr>
          <th>
            {{'label.list.date' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('DATE')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'DATE' && sortByAsc) || (sortByCondition !== 'DATE' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
            </button>
          </th>
          <th>  {{'label.list.start' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('START')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'START' && sortByAsc) || (sortByCondition !== 'START' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
            </button>
          </th>
          <th>{{'label.list.end' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('END')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'END' && sortByAsc) || (sortByCondition !== 'END' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
            </button>
          </th>
          <th>{{'label.list.first.name' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('FIRST_NAME')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'FIRST_NAME' && sortByAsc) || (sortByCondition !== 'FIRST_NAME' && !sortByAsc))  ? 'icon-caret-down': 'icon-caret-up'"></i>
            </button>
          </th>
          <th> {{'label.list.last.name' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('LAST_NAME')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'LAST_NAME' && sortByAsc) || (sortByCondition !== 'LAST_NAME' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
            </button>
          </th>
          <th> {{'label.list.resource' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('RESOURCE')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'RESOURCE' && sortByAsc) || (sortByCondition !== 'RESOURCE' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
            </button>
          </th>
          <th> {{'label.list.notes' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('NOTE')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'NOTE' && sortByAsc) || (sortByCondition !== 'NOTE' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
            </button>
          </th>
          <th>  {{'label.list.services' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('SERVICES')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'SERVICES' && sortByAsc) || (sortByCondition !== 'SERVICES' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
            </button>
          </th>
          <th>{{'label.list.email' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('EMAIL')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'EMAIL' && sortByAsc) || (sortByCondition !== 'EMAIL' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
            </button>
          </th>
          <th> {{'label.list.phone' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('PHONE')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'PHONE' && sortByAsc) || (sortByCondition !== 'PHONE' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
            </button>
          </th>
          <th> {{'label.list.updated' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('UPDATED')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'UPDATED' && sortByAsc) || (sortByCondition !== 'UPDATED' && !sortByAsc)) ? 'icon-caret-down': 'icon-caret-up'"></i>
            </button>
          </th>
          <th>{{'label.list.status' | translate}} 
            <button class="qm-transparent-btn" (click)="sortByChange('STATUS')">
              <i class="sort-icon"
                [ngClass]="((sortByCondition === 'STATUS' && sortByAsc) || (sortByCondition !== 'STATUS' && !sortByAsc))? 'icon-caret-down': 'icon-caret-up'"></i>
            </button>
          </th>
      
        </tr>
        <tr *ngFor="let appointment of fulAppointmentList">
          <td> {{ appointment.startTime | amDateFormat: 'DD-MM-YYYY' }}</td>
          <td> {{ appointment.startTime | amDateFormat: (isMilitaryTime ? 'HH:mm' : 'hh:mm A') }}</td>
          <td> {{ appointment.endTime | amDateFormat: (isMilitaryTime ? 'HH:mm' : 'hh:mm A') }}</td>
          <td> {{ appointment.customers[0].firstName }}</td>
          <td> {{ appointment.customers[0].lastName }}</td>
          <td> {{ appointment.resourceName }}</td>
          <td> {{ getNotes(appointment.properties.notes) }}</td>
          <td> {{ appointment.services[0].name }}</td>
          <td> {{ appointment.customers[0].properties.email }}</td>
          <td> {{ appointment.customers[0].properties.phoneNumber }}</td>
          <td> {{ appointment.updateTime | amDateFormat: (isMilitaryTime ? 'DD-MM-YYYY - HH:mm' : 'DD-MM-YYYY - hh:mm
            A') }}</td>
          <td> {{ appointment.status }}</td>
        </tr>
      </table>
    </div>
    <!-- End of fake table -->
    <div style="display: flex;"  *ngIf="appointmentList && appointmentList.length > 0"> 
    {{updateDetailList()}}
    </div>
    <div style="display: flex;"  *ngIf="(fulAppointmentList && fulAppointmentList.length > 0) && appointmentList.length === 0 "> 
      {{'label.list.no.items' | translate}} 
      </div>
    <div class="qm-pagination-container">
      <ngb-pagination *ngIf="appointmentList && appointmentList.length > 0" [(page)]="currentPage" [pageSize]="elementsPerPage" [collectionSize]="appointmentList.length" [maxSize]="10" [boundaryLinks]="true"></ngb-pagination>
    </div>
      
    
    <div class="qm-no-appointment" *ngIf="fulAppointmentList.length == 0 ">
      <div class="qm-no-appointment__text">
        {{'label.list.entry.label' | translate}} 
       
      </div>
    </div>
  </div>